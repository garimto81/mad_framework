# PRD-0034: CLAUDE.md 분리 및 경량화

**버전**: 1.0.0 | **상태**: Draft | **작성일**: 2025-12-16

**상위 PRD**: PRD-0033 (Claude Config Optimization - Phase 1)

---

## 1. 개요

### 1.1 문제 정의

현재 CLAUDE.md 파일의 문제:

| 문제 | 현황 | 영향 |
|------|------|------|
| **과도한 길이** | 369줄 | 초기 로딩 토큰 ~3,000 |
| **혼합된 정보** | 규칙 + 상세 + 이력 혼재 | 핵심 규칙 파악 어려움 |
| **중복 참조** | 상세 문서가 이미 존재 | 유지보수 이중 부담 |

### 1.2 목표

| 목표 | 측정 지표 |
|------|----------|
| CLAUDE.md 경량화 | 369줄 → 100줄 이하 |
| 초기 로딩 최적화 | ~3,000 토큰 → ~1,000 토큰 |
| 점진적 공개 적용 | 상세 정보는 필요 시 참조 |

### 1.3 설계 원칙

```
┌─────────────────────────────────────────────────────────────┐
│                    점진적 공개 (Progressive Disclosure)       │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Level 1: CLAUDE.md (~100줄)                                │
│  └─ 핵심 규칙만, 항상 로드                                   │
│                                                              │
│  Level 2: docs/*.md (필요 시)                               │
│  └─ 상세 정보, 참조 시에만 로드                              │
│                                                              │
│  Level 3: .claude/*/ (실행 시)                              │
│  └─ 커맨드/스킬/에이전트 상세, 호출 시에만 로드              │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 2. 현황 분석

### 2.1 현재 CLAUDE.md 구조 (369줄)

```
┌────────────────────────────────────────────────────────────────┐
│  섹션                        │ 줄 수 │ 분류        │ 처리      │
├────────────────────────────────────────────────────────────────┤
│  헤더 + 기본 규칙            │  18   │ 핵심        │ ✅ 유지   │
│  비개발자 응답 모드          │  48   │ 상세        │ 📤 분리   │
│  응답 스타일                 │  21   │ 상세        │ 📤 분리   │
│  프로젝트 구조               │  13   │ 핵심        │ ✅ 유지   │
│  빌드/테스트 명령어          │  64   │ 상세        │ 📤 분리   │
│  에이전트                    │  24   │ 요약+참조   │ ✂️ 축소   │
│  핵심 규칙 (Hook)            │  14   │ 핵심        │ ✅ 유지   │
│  작업 방법                   │  12   │ 핵심        │ ✅ 유지   │
│  커맨드                      │  38   │ 요약+참조   │ ✂️ 축소   │
│  MCP 서버                    │  18   │ 요약+참조   │ ✂️ 축소   │
│  스킬                        │  12   │ 요약+참조   │ ✂️ 축소   │
│  안전 규칙                   │  10   │ 핵심        │ ✅ 유지   │
│  문제 해결                   │   7   │ 핵심        │ ✅ 유지   │
│  참조                        │  11   │ 핵심        │ ✅ 유지   │
│  변경 이력                   │  17   │ 상세        │ 📤 분리   │
├────────────────────────────────────────────────────────────────┤
│  합계                        │ 369   │             │           │
│  ✅ 유지                     │  85   │             │           │
│  📤 분리                     │ 150   │             │           │
│  ✂️ 축소                     │  92   │ → 30줄     │           │
└────────────────────────────────────────────────────────────────┘
```

### 2.2 분리 후 예상 구조

| 파일 | 내용 | 예상 줄 수 |
|------|------|-----------|
| **CLAUDE.md** | 핵심 규칙 + 빠른 참조 | ~95줄 |
| **docs/RESPONSE_STYLE.md** | 비개발자 모드 + 응답 스타일 | ~75줄 |
| **docs/BUILD_TEST.md** | 빌드/테스트 명령어 상세 | ~70줄 |
| **docs/CHANGELOG-CLAUDE.md** | CLAUDE.md 변경 이력 | ~25줄 |

---

## 3. 분리 설계

### 3.1 새 CLAUDE.md 구조 (~95줄)

```markdown
# CLAUDE.md

**Version**: 11.0.0 | **Context**: Windows, PowerShell

---

## 기본 규칙

| 규칙 | 내용 |
|------|------|
| **언어** | 한글 출력. 기술 용어는 영어 |
| **경로** | 절대 경로만 |
| **충돌** | 사용자에게 질문 |
| **응답 스타일** | 상세: `docs/RESPONSE_STYLE.md` |

---

## 프로젝트 구조

(기존 유지 - 13줄)

---

## 핵심 규칙 (Hook 강제)

(기존 유지 - 14줄)

---

## 작업 방법

(기존 유지 - 12줄)

---

## 빠른 참조

### 커맨드 (상위 5개)

| 커맨드 | 용도 |
|--------|------|
| `/work` | 전체 워크플로우 |
| `/issue` | 이슈 관리 |
| `/commit` | 커밋 생성 |
| `/check` | 린트/테스트 |
| `/tdd` | TDD 워크플로우 |

전체 13개: `docs/COMMAND_REFERENCE.md`

### 에이전트 (상위 4개)

| Agent | 용도 |
|-------|------|
| `code-reviewer` | 코드 리뷰 |
| `architect` | 설계 |
| `debugger` | 버그 분석 |
| `test-engineer` | 테스트 |

전체 19개: `docs/AGENTS_REFERENCE.md`

---

## 안전 규칙

(기존 유지 - 10줄)

---

## 문제 해결

(기존 유지 - 7줄)

---

## 참조

| 문서 | 용도 |
|------|------|
| `docs/RESPONSE_STYLE.md` | 응답 스타일 상세 |
| `docs/BUILD_TEST.md` | 빌드/테스트 명령어 |
| `docs/COMMAND_REFERENCE.md` | 커맨드 상세 |
| `docs/AGENTS_REFERENCE.md` | 에이전트 상세 |
| `docs/CHANGELOG-CLAUDE.md` | 변경 이력 |
```

### 3.2 docs/RESPONSE_STYLE.md (~75줄)

```markdown
# Response Style Guide

비개발자 응답 모드 및 응답 스타일 가이드입니다.

---

## 비개발자 응답 모드

**목적**: 로직 흐름 이해 + 실수 가능성 검토

### 숨김 처리 대상
(기존 내용)

### 필수 표시 대상
(기존 내용)

### 시각화 규칙
(기존 내용)

### 응답 구조
(기존 내용)

---

## 응답 스타일

작업 완료 시 아래 형식으로 마무리:
(기존 내용)
```

### 3.3 docs/BUILD_TEST.md (~70줄)

```markdown
# Build & Test Guide

프로젝트별 빌드 및 테스트 명령어입니다.

---

## Python 프로젝트
(기존 내용)

---

## VTC_Logger (React + Vite)
(기존 내용)

---

## E2E 테스트 (Playwright)

### 규칙
(기존 내용)

### 결과 출력 형식
(기존 내용)
```

### 3.4 docs/CHANGELOG-CLAUDE.md (~25줄)

```markdown
# CLAUDE.md Changelog

| 버전 | 날짜 | 변경 |
|------|------|------|
| 11.0.0 | 2025-12-16 | PRD-0034: 파일 분리 (369줄 → 95줄) |
| 10.4.4 | 2025-12-16 | MCP 정리 (5개 → 1개) |
...
```

---

## 4. 구현 단계

### 4.1 단계별 작업

```
┌─────────────────────────────────────────────────────────────┐
│  Step 1: 분리 파일 생성                                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1.1 docs/RESPONSE_STYLE.md 생성                            │
│      - 비개발자 응답 모드 (21-68줄) 이동                     │
│      - 응답 스타일 (72-92줄) 이동                            │
│                                                              │
│  1.2 docs/BUILD_TEST.md 생성                                │
│      - 빌드/테스트 명령어 (112-175줄) 이동                   │
│                                                              │
│  1.3 docs/CHANGELOG-CLAUDE.md 생성                          │
│      - 변경 이력 (352-368줄) 이동                            │
│                                                              │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 2: CLAUDE.md 경량화                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  2.1 분리된 섹션 제거                                        │
│  2.2 커맨드/에이전트/MCP/스킬 축소 (상위 5개만)              │
│  2.3 참조 링크 추가                                          │
│  2.4 버전 업데이트 (10.4.4 → 11.0.0)                        │
│                                                              │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Step 3: 검증                                                │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  3.1 줄 수 확인 (목표: < 100줄)                              │
│  3.2 참조 링크 유효성 검증                                   │
│  3.3 하위 프로젝트 적용 확인 (VTC_Logger)                    │
│  3.4 새 세션에서 동작 테스트                                 │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 4.2 상세 작업 목록

| # | 작업 | 입력 | 출력 | 검증 |
|---|------|------|------|------|
| 1.1 | RESPONSE_STYLE.md 생성 | CLAUDE.md 21-92줄 | docs/RESPONSE_STYLE.md | 파일 존재 |
| 1.2 | BUILD_TEST.md 생성 | CLAUDE.md 112-175줄 | docs/BUILD_TEST.md | 파일 존재 |
| 1.3 | CHANGELOG-CLAUDE.md 생성 | CLAUDE.md 352-368줄 | docs/CHANGELOG-CLAUDE.md | 파일 존재 |
| 2.1 | 분리 섹션 제거 | CLAUDE.md | CLAUDE.md 수정 | 줄 수 감소 |
| 2.2 | 요약 섹션 축소 | 커맨드/에이전트 등 | 상위 5개만 | 줄 수 감소 |
| 2.3 | 참조 링크 추가 | - | 각 섹션 끝 | 링크 확인 |
| 2.4 | 버전 업데이트 | 10.4.4 | 11.0.0 | 헤더 확인 |
| 3.1 | 줄 수 검증 | CLAUDE.md | < 100줄 | `wc -l` |
| 3.2 | 링크 검증 | 참조 문서 | 모두 존재 | `ls` |
| 3.3 | 하위 적용 확인 | VTC_Logger | 상속 동작 | 세션 테스트 |

---

## 5. 파일 매핑

### 5.1 이동 매핑

```
CLAUDE.md (현재)                    → 분리 후
────────────────────────────────────────────────────────
21-68줄  (비개발자 응답 모드)       → docs/RESPONSE_STYLE.md
72-92줄  (응답 스타일)              → docs/RESPONSE_STYLE.md
112-175줄 (빌드/테스트 명령어)      → docs/BUILD_TEST.md
352-368줄 (변경 이력)               → docs/CHANGELOG-CLAUDE.md
```

### 5.2 축소 매핑

```
CLAUDE.md 섹션                      현재 → 목표
────────────────────────────────────────────────────────
에이전트 (179-202줄)                24줄 → 8줄 (상위 4개 + 참조)
커맨드 (238-275줄)                  38줄 → 10줄 (상위 5개 + 참조)
MCP 서버 (279-296줄)                18줄 → 5줄 (요약 + 참조)
스킬 (300-311줄)                    12줄 → 5줄 (요약 + 참조)
```

---

## 6. 예상 효과

### 6.1 정량적 효과

| 지표 | 현재 | 목표 | 개선율 |
|------|------|------|--------|
| CLAUDE.md 줄 수 | 369줄 | 95줄 | **-74%** |
| 초기 로딩 토큰 | ~3,000 | ~900 | **-70%** |
| 핵심 규칙 비율 | 23% | 89% | **+287%** |

### 6.2 토큰 계산

```
현재: 369줄 × ~8 토큰/줄 ≈ 2,952 토큰
목표:  95줄 × ~9 토큰/줄 ≈   855 토큰
절감: ~2,100 토큰 (매 세션마다)
```

---

## 7. 리스크 및 대응

| 리스크 | 확률 | 영향 | 대응 |
|--------|------|------|------|
| 분리 후 정보 누락 | 중 | 중 | 체크리스트로 검증 |
| 참조 링크 깨짐 | 낮 | 중 | 상대 경로 사용, ls 검증 |
| 하위 프로젝트 영향 | 낮 | 높 | 분리 전 VTC_Logger 백업 |
| 기존 사용자 혼란 | 중 | 낮 | 참조 섹션에 안내 추가 |

---

## 8. 검증 체크리스트

### 8.1 분리 완료 후

- [ ] CLAUDE.md 줄 수 < 100
- [ ] docs/RESPONSE_STYLE.md 존재
- [ ] docs/BUILD_TEST.md 존재
- [ ] docs/CHANGELOG-CLAUDE.md 존재
- [ ] 모든 참조 링크 유효

### 8.2 동작 검증

- [ ] 새 세션에서 CLAUDE.md 로드 확인
- [ ] "비개발자 모드" 언급 시 RESPONSE_STYLE.md 참조 가능
- [ ] "빌드 명령어" 질문 시 BUILD_TEST.md 참조 가능
- [ ] VTC_Logger 디렉토리에서 규칙 상속 동작

---

## 버전 이력

| 버전 | 날짜 | 변경 |
|------|------|------|
| 1.0.0 | 2025-12-16 | 초안 작성 |
